{% extends "search_index/base.html" %}

{% block content %}
<div class="container mt-4">
    <form method="get" action="{% url 'search_index:simple_search' %}" class="form-inline mb-4">
        <input type="text" name="query" maxlength="100" value="{{ query|default:'' }}" placeholder="请输入搜索关键词" class="form-control mr-sm-2">
        <button class="btn btn-primary" type="submit">搜索</button>
    </form>

    {% if query %}
        <p>您当前的 IP 地址是: {{ client_ip }}</p>
        <h2>搜索关键词: "{{ query }}"</h2>
        <h3>搜索结果: 共 {{ total }} 条</h3>

        <ul>
            {% for result in results %}
                <li>
                    <!-- 包裹整个搜索结果为一个 div 盒子 -->
                    <div class="search-result-box" onclick="window.location.href='{% url 'search_index:book_detail' book_id=result.book_id %}'">
                        <div class="row">
                            <!-- 左侧封面图片 -->
                            <div class="col-md-3">
                                <img src="{{ result.cover }}" alt="封面" class="img-fluid rounded" style="max-height: 150px; object-fit: cover;">
                            </div>
                            <!-- 右侧内容 -->
                            <div class="col-md-9">
                                {% if result.highlight %}
                                    <p>匹配结果: {{ result.highlight|safe }}</p>
                                {% endif %}
                                <p><strong>书名:</strong> {{ result.bookName }}</p>
                                <p><strong>作者:</strong> {{ result.authors }}</p>
                            </div>
                        </div>
                    </div>
                </li>
            {% endfor %}
        </ul>

        {% if pages > 1 %}
            <nav>
                <ul class="pagination">
                    <!-- 上一页 -->
                    {% if current_page > 1 %}
                        <li class="page-item">
                            <a class="page-link" href="?query={{ query }}&page={{ current_page|add:"-1" }}">上一页</a>
                        </li>
                    {% endif %}

                    <!-- 分页范围 -->
                    {% for i in pagination_range %}
                        <li class="page-item {% if i == current_page %}active{% endif %}">
                            <a class="page-link" href="?query={{ query }}&page={{ i }}">{{ i }}</a>
                        </li>
                    {% endfor %}

                    <!-- 下一页 -->
                    {% if current_page < pages %}
                        <li class="page-item">
                            <a class="page-link" href="?query={{ query }}&page={{ current_page|add:"1" }}">下一页</a>
                        </li>
                    {% endif %}
                </ul>
            </nav>
        {% endif %}
    {% endif %}
</div>

{% block extra_styles %}
<style>
    .search-result-box {
        cursor: pointer; /* 鼠标悬停时显示为手型 */
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        background-color: #f9f9f9;
        transition: background-color 0.3s ease;
    }

    .search-result-box:hover {
        background-color: #f0f0f0;
    }

    .search-result-box p {
        margin: 5px 0;
    }

    /* 添加封面图片的样式 */
    .search-result-box img {
        max-width: 100%; /* 保证图片不超出宽度 */
        border-radius: 5px;
    }
</style>
{% endblock %}




{% endblock %}
